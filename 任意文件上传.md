# Vulnerability Introduction

The 2.0 version of the UploadController. java interface of newbee all plus has an arbitrary file upload vulnerability. Attackers can use the suffixName parameter to change the file suffix after uploading, thereby bypassing the front-end file suffix detection and achieving arbitrary file upload vulnerabilities. This may also lead to getshell, causing more serious consequences.

# Vulnerability analysis

Vulnerabilities class file:src/main/java/ltd/newbee/mall/controller/common/UploadController.java

![17833f2206697962c409c89a5ec09568](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/1.5j4noth69d.webp)

In the upload method, after receiving the file suffix, no processing is performed on the file suffix, which allows attackers to upload any type of file and creates an arbitrary file upload vulnerability

# Vulnerability reproduction

![274d9f62-4b89-4573-8183-078fdde918b0](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/2.wj0o4imlt.webp)

In the add product information interface, click the upload product main image button, and then randomly select an image file. Use Burpsuite to capture the package and obtain the following data package

![276e0974d8d52a57a94bc71ebf6d5115](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/3.6f1549qupg.webp)

Modify the filename parameter to a JSP file extension and add malicious code to the file content

![92e0feddb38ab11133a5603d44ce22ef](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/4.102mlubpbp.webp)

Then pack the package, find that the file has been successfully added, enter the relevant product information, and click save product

![f399fd55d4fba671a907954f53962dd0](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/5.96a7cccyra.webp)

Then, on the product management page, click on the corresponding product image, right-click, and select 'Check'

![7772955ddb22fb92d2caf03ac8a377d9](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/6.6t7kv4z5kn.webp)

You can see the file path and indeed find that the JSP file exists in the local folder, causing any file upload vulnerability.

![dfcfebe3b3c292d50ec4a6412fc10877](https://github.com/zyhzheng500-maker/picx-images-hosting/raw/master/ecms/7.3uvarmqw3d.webp)
